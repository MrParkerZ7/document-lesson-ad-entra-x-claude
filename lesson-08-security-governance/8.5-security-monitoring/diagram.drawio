<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-01-15T10:00:00.000Z" agent="5.0" version="21.0.0" type="device">
  <diagram name="Security Monitoring" id="security-monitoring-diagram">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="1">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Security Monitoring Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=22;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="400" height="40" as="geometry" />
        </mxCell>

        <!-- Section 1: Log Types -->
        <mxCell id="logs-title" value="Log Sources" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="80" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <!-- Audit Logs Box -->
        <mxCell id="audit-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="110" width="180" height="140" as="geometry" />
        </mxCell>
        <mxCell id="audit-title" value="Audit Logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="40" y="115" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="audit-1" value="User Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="140" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="audit-2" value="Role Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="167" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="audit-3" value="Policy Changes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="194" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="audit-4" value="App Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="221" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- Sign-in Logs Box -->
        <mxCell id="signin-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="270" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="signin-title" value="Sign-in Logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="40" y="275" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="signin-1" value="Interactive Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="300" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="signin-2" value="Non-Interactive Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="327" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="signin-3" value="Service Principal Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="354" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="signin-4" value="Managed Identity Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="381" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- Risk Logs Box -->
        <mxCell id="risk-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="450" width="180" height="110" as="geometry" />
        </mxCell>
        <mxCell id="risk-title" value="Risk Logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="40" y="455" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="risk-1" value="Risky Users" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="480" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="risk-2" value="Risk Detections" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="507" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="risk-3" value="Service Principal Risk" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="534" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- Section 2: Diagnostic Settings -->
        <mxCell id="diag-title" value="Diagnostic Settings" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="340" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <mxCell id="diag-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="110" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="diag-box-title" value="Export Configuration" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="300" y="115" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="diag-1" value="Select Log Categories" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="145" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="diag-2" value="Configure Destinations" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="180" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="diag-3" value="Set Retention Policies" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="215" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="diag-4" value="Enable Streaming" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="250" width="160" height="25" as="geometry" />
        </mxCell>

        <!-- Section 3: Destinations -->
        <mxCell id="dest-title" value="Export Destinations" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="600" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <!-- Log Analytics Box -->
        <mxCell id="law-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="110" width="200" height="130" as="geometry" />
        </mxCell>
        <mxCell id="law-title" value="Log Analytics Workspace" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="560" y="115" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="law-1" value="KQL Queries" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="145" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-2" value="Workbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="665" y="145" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-3" value="Alert Rules" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="180" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-4" value="Dashboards" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="665" y="180" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-retention" value="Retention: 90 days - 12 years" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=9;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="580" y="212" width="160" height="20" as="geometry" />
        </mxCell>

        <!-- Storage Account Box -->
        <mxCell id="storage-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="260" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="storage-title" value="Storage Account" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="560" y="265" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="storage-1" value="Hot Tier (0-90 days)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="290" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="storage-2" value="Cool/Archive (Long-term)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="318" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="storage-retention" value="Retention: Unlimited" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=9;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="612" y="342" width="100" height="15" as="geometry" />
        </mxCell>

        <!-- Event Hub Box -->
        <mxCell id="eventhub-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="380" width="200" height="90" as="geometry" />
        </mxCell>
        <mxCell id="eventhub-title" value="Event Hub" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="560" y="385" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="eventhub-1" value="Real-time Streaming" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d79b00;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="410" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="eventhub-2" value="Consumer Groups" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d79b00;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="438" width="170" height="22" as="geometry" />
        </mxCell>

        <!-- Section 4: SIEM & Analysis -->
        <mxCell id="siem-title" value="SIEM & Analysis" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="880" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <!-- Microsoft Sentinel Box -->
        <mxCell id="sentinel-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="830" y="110" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-title" value="Microsoft Sentinel" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="830" y="115" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-1" value="Analytics Rules" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="145" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-2" value="Incidents" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="145" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-3" value="Hunting" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="180" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-4" value="Playbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="180" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-native" value="Native Entra ID Connector" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=9;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="865" y="212" width="150" height="20" as="geometry" />
        </mxCell>

        <!-- Third-party SIEM Box -->
        <mxCell id="thirdsiem-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="830" y="260" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-title" value="Third-party SIEM" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="830" y="265" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-1" value="Splunk" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="295" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-2" value="QRadar" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="295" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-3" value="Chronicle" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="330" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-4" value="Elastic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="330" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-via" value="Via Event Hub" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=9;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="890" y="362" width="100" height="20" as="geometry" />
        </mxCell>

        <!-- Section 5: Alerting & Response -->
        <mxCell id="alert-title" value="Alerting & Response" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="1120" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <mxCell id="alert-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="1100" y="110" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="alert-box-title" value="Security Response" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1100" y="115" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="alert-1" value="Real-time Alerts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1120" y="145" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="alert-2" value="Email Notifications" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1120" y="180" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="alert-3" value="Automated Playbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1120" y="215" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="alert-4" value="Incident Creation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1120" y="250" width="160" height="25" as="geometry" />
        </mxCell>

        <!-- Flow Arrows from Logs to Diagnostic Settings -->
        <mxCell id="arrow-audit-diag" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#9673a6;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.25;" edge="1" parent="1" source="audit-box" target="diag-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="180" />
              <mxPoint x="280" y="155" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-signin-diag" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#6c8ebf;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" parent="1" source="signin-box" target="diag-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="350" />
              <mxPoint x="270" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-risk-diag" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#b85450;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.75;" edge="1" parent="1" source="risk-box" target="diag-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="250" y="505" />
              <mxPoint x="270" y="245" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Flow Arrows from Diagnostic Settings to Destinations -->
        <mxCell id="arrow-diag-law" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#82b366;strokeWidth=2;exitX=1;exitY=0.25;entryX=0;entryY=0.5;" edge="1" parent="1" source="diag-box" target="law-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="155" />
              <mxPoint x="530" y="175" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-diag-storage" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#6c8ebf;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" parent="1" source="diag-box" target="storage-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="200" />
              <mxPoint x="530" y="310" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-diag-eventhub" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#d79b00;strokeWidth=2;exitX=1;exitY=0.75;entryX=0;entryY=0.5;" edge="1" parent="1" source="diag-box" target="eventhub-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="245" />
              <mxPoint x="540" y="425" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Flow Arrows from Destinations to SIEM -->
        <mxCell id="arrow-law-sentinel" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#9673a6;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" parent="1" source="law-box" target="sentinel-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="785" y="175" />
              <mxPoint x="800" y="175" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-eventhub-thirdsiem" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#d6b656;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" parent="1" source="eventhub-box" target="thirdsiem-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="785" y="425" />
              <mxPoint x="800" y="325" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Flow Arrows to Alerting -->
        <mxCell id="arrow-sentinel-alert" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#b85450;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.3;" edge="1" parent="1" source="sentinel-box" target="alert-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1070" y="175" />
              <mxPoint x="1080" y="164" />
            </Array>
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-thirdsiem-alert" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#b85450;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.7;" edge="1" parent="1" source="thirdsiem-box" target="alert-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1070" y="325" />
              <mxPoint x="1080" y="236" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Bottom Section: KQL Query Flow -->
        <mxCell id="kql-title" value="Analysis Workflow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="500" y="510" width="300" height="30" as="geometry" />
        </mxCell>

        <mxCell id="kql-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="550" width="700" height="120" as="geometry" />
        </mxCell>

        <mxCell id="kql-step1" value="1. Failed Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=2;shadow=1;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="320" y="575" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kql-step2" value="2. Risky Users" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=2;shadow=1;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="465" y="575" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kql-step3" value="3. PIM Activations" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=2;shadow=1;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="610" y="575" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kql-step4" value="4. App Consent" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=2;shadow=1;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="755" y="575" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kql-step5" value="5. Role Changes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=2;shadow=1;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="575" width="120" height="40" as="geometry" />
        </mxCell>

        <mxCell id="kql-query" value="KQL: SigninLogs | where ResultType != 0 | summarize count() by UserPrincipalName" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;fontStyle=2;align=center;" vertex="1" parent="1">
          <mxGeometry x="340" y="625" width="640" height="30" as="geometry" />
        </mxCell>

        <!-- KQL step arrows -->
        <mxCell id="kql-arrow1" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1" source="kql-step1" target="kql-step2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="455" y="595" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kql-arrow2" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1" source="kql-step2" target="kql-step3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="600" y="595" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kql-arrow3" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1" source="kql-step3" target="kql-step4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="745" y="595" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kql-arrow4" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1" source="kql-step4" target="kql-step5">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="890" y="595" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Retention Timeline -->
        <mxCell id="retention-title" value="Retention Tiers" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="500" y="690" width="300" height="30" as="geometry" />
        </mxCell>

        <mxCell id="ret-hot" value="Hot Storage&#xa;0-90 days&#xa;Direct Query" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;shadow=1;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="730" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="ret-warm" value="Warm Storage&#xa;90 days - 2 years&#xa;Restore to Query" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;shadow=1;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="730" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="ret-cold" value="Cold Storage&#xa;2+ years&#xa;Compliance Archive" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="820" y="730" width="180" height="60" as="geometry" />
        </mxCell>

        <mxCell id="ret-arrow1" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1" source="ret-hot" target="ret-warm">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ret-arrow2" style="curved=1;endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1" source="ret-warm" target="ret-cold">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="780" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- PowerShell Access -->
        <mxCell id="ps-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="590" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="ps-title" value="PowerShell Access" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="40" y="595" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ps-1" value="Get-MgAuditLog*" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="620" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="ps-2" value="Get-MgRiskDetection" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="648" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="ps-note" value="Microsoft Graph API" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=9;fontStyle=2;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="55" y="672" width="150" height="15" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
