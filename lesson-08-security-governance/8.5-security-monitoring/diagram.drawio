<mxfile host="app.diagrams.net" modified="2024-01-15T10:00:00.000Z" agent="5.0" version="21.0.0" type="device">
  <diagram name="Security Monitoring" id="security-monitoring-diagram">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="1">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Security Monitoring Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=22;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="400" height="40" as="geometry" />
        </mxCell>

        <!-- Section 1: Log Types -->
        <mxCell id="logs-title" value="Log Sources" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="80" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <!-- Audit Logs Box -->
        <mxCell id="audit-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="110" width="180" height="140" as="geometry" />
        </mxCell>
        <mxCell id="audit-title" value="Audit Logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="40" y="115" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="audit-1" value="User Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="140" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="audit-2" value="Role Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="167" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="audit-3" value="Policy Changes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="194" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="audit-4" value="App Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="221" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- Sign-in Logs Box -->
        <mxCell id="signin-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="270" width="180" height="160" as="geometry" />
        </mxCell>
        <mxCell id="signin-title" value="Sign-in Logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="40" y="275" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="signin-1" value="Interactive Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="300" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="signin-2" value="Non-Interactive Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="327" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="signin-3" value="Service Principal Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="354" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="signin-4" value="Managed Identity Sign-ins" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="381" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- Risk Logs Box -->
        <mxCell id="risk-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="450" width="180" height="110" as="geometry" />
        </mxCell>
        <mxCell id="risk-title" value="Risk Logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="40" y="455" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="risk-1" value="Risky Users" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="480" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="risk-2" value="Risk Detections" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="507" width="150" height="22" as="geometry" />
        </mxCell>
        <mxCell id="risk-3" value="Service Principal Risk" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="55" y="534" width="150" height="22" as="geometry" />
        </mxCell>

        <!-- Section 2: Diagnostic Settings -->
        <mxCell id="diag-title" value="Diagnostic Settings" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="340" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <mxCell id="diag-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="110" width="200" height="180" as="geometry" />
        </mxCell>
        <mxCell id="diag-box-title" value="Export Configuration" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="300" y="115" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="diag-1" value="Select Log Categories" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="145" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="diag-2" value="Configure Destinations" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="180" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="diag-3" value="Set Retention Policies" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="215" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="diag-4" value="Enable Streaming" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="250" width="160" height="25" as="geometry" />
        </mxCell>

        <!-- Section 3: Destinations -->
        <mxCell id="dest-title" value="Export Destinations" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="600" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <!-- Log Analytics Box -->
        <mxCell id="law-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="110" width="200" height="130" as="geometry" />
        </mxCell>
        <mxCell id="law-title" value="Log Analytics Workspace" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="560" y="115" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="law-1" value="KQL Queries" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="145" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-2" value="Workbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="665" y="145" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-3" value="Alert Rules" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="180" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-4" value="Dashboards" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="665" y="180" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="law-retention" value="Retention: 90 days - 12 years" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=9;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="580" y="212" width="160" height="20" as="geometry" />
        </mxCell>

        <!-- Storage Account Box -->
        <mxCell id="storage-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="260" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="storage-title" value="Storage Account" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="560" y="265" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="storage-1" value="Hot Tier (0-90 days)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="290" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="storage-2" value="Cool/Archive (Long-term)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="318" width="170" height="22" as="geometry" />
        </mxCell>

        <!-- Event Hub Box -->
        <mxCell id="eventhub-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="380" width="200" height="90" as="geometry" />
        </mxCell>
        <mxCell id="eventhub-title" value="Event Hub" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="560" y="385" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="eventhub-1" value="Real-time Streaming" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d79b00;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="410" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="eventhub-2" value="Consumer Groups" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d79b00;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="575" y="438" width="170" height="22" as="geometry" />
        </mxCell>

        <!-- Section 4: SIEM -->
        <mxCell id="siem-title" value="SIEM Integration" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=16;fontStyle=1;fontColor=#0078D4;" vertex="1" parent="1">
          <mxGeometry x="880" y="70" width="200" height="30" as="geometry" />
        </mxCell>

        <!-- Microsoft Sentinel Box -->
        <mxCell id="sentinel-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="830" y="110" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-title" value="Microsoft Sentinel" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="830" y="115" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-1" value="Analytics Rules" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="145" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-2" value="Incidents" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="145" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-3" value="Hunting" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="180" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sentinel-4" value="Playbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="180" width="90" height="25" as="geometry" />
        </mxCell>

        <!-- Third-party SIEM Box -->
        <mxCell id="thirdsiem-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="830" y="260" width="220" height="110" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-title" value="Third-party SIEM" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="830" y="265" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-1" value="Splunk" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="295" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-2" value="QRadar" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="295" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-3" value="Elastic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="330" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="thirdsiem-4" value="Chronicle" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="330" width="90" height="25" as="geometry" />
        </mxCell>

        <!-- Alerting Section -->
        <mxCell id="alert-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="830" y="390" width="220" height="100" as="geometry" />
        </mxCell>
        <mxCell id="alert-title" value="Security Response" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="830" y="395" width="220" height="20" as="geometry" />
        </mxCell>
        <mxCell id="alert-1" value="Real-time Alerts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="420" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="alert-2" value="Playbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="420" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="alert-3" value="Email Notifications" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="845" y="455" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="alert-4" value="Incidents" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="945" y="455" width="90" height="25" as="geometry" />
        </mxCell>

        <!-- Flow Arrows -->
        <mxCell id="arrow1" style="endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="220" y="250" as="sourcePoint" />
            <mxPoint x="300" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow2" style="endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="500" y="200" as="sourcePoint" />
            <mxPoint x="560" y="175" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow3" style="endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="500" y="200" as="sourcePoint" />
            <mxPoint x="560" y="310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow4" style="endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="500" y="200" as="sourcePoint" />
            <mxPoint x="560" y="425" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow5" style="endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="760" y="175" as="sourcePoint" />
            <mxPoint x="830" y="175" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow6" style="endArrow=blockThin;endFill=1;strokeColor=#0078D4;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="760" y="425" as="sourcePoint" />
            <mxPoint x="830" y="315" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- PowerShell Box -->
        <mxCell id="ps-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="320" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="ps-title" value="PowerShell / Graph API" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="300" y="325" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ps-1" value="Get-MgAuditLogSignIn" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="355" width="160" height="22" as="geometry" />
        </mxCell>
        <mxCell id="ps-2" value="Get-MgAuditLogDirectoryAudit" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="385" width="160" height="22" as="geometry" />
        </mxCell>

        <!-- KQL Section -->
        <mxCell id="kql-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="590" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="kql-title" value="KQL Query Examples" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="40" y="595" width="400" height="20" as="geometry" />
        </mxCell>
        <mxCell id="kql-1" value="SigninLogs | where ResultType != 0" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="625" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="kql-2" value="AuditLogs | where Category == 'RoleManagement'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="250" y="625" width="170" height="22" as="geometry" />
        </mxCell>
        <mxCell id="kql-3" value="AADRiskyUsers | where RiskLevel == 'high'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="150" y="655" width="180" height="22" as="geometry" />
        </mxCell>

        <!-- Best Practices -->
        <mxCell id="bp-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="520" width="300" height="170" as="geometry" />
        </mxCell>
        <mxCell id="bp-title" value="Best Practices" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="480" y="525" width="300" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-1" value="Enable all log categories" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="500" y="560" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-2" value="Set appropriate retention" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="640" y="560" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-3" value="Configure alerts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="500" y="595" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-4" value="Use workbooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="640" y="595" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-5" value="Integrate with SIEM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="500" y="630" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-6" value="Review regularly" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="640" y="630" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="bp-note" value="P1/P2 license required for advanced logs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=9;fontStyle=2;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="520" y="660" width="220" height="20" as="geometry" />
        </mxCell>

        <!-- Retention Info -->
        <mxCell id="ret-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="810" y="520" width="250" height="170" as="geometry" />
        </mxCell>
        <mxCell id="ret-title" value="Retention Periods" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="810" y="525" width="250" height="25" as="geometry" />
        </mxCell>
        <mxCell id="ret-1" value="Portal: 7-30 days (Free)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="830" y="560" width="210" height="25" as="geometry" />
        </mxCell>
        <mxCell id="ret-2" value="Log Analytics: 90 days - 12 years" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="830" y="595" width="210" height="25" as="geometry" />
        </mxCell>
        <mxCell id="ret-3" value="Storage Account: Unlimited" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;strokeWidth=1;shadow=1;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="830" y="630" width="210" height="25" as="geometry" />
        </mxCell>
        <mxCell id="ret-note" value="Configure based on compliance needs" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=9;fontStyle=2;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="830" y="660" width="210" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
